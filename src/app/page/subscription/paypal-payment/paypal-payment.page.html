<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/"></ion-back-button>
    </ion-buttons>
    <ion-title>Review and pay</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-row class="wave-background">
    <ion-col>
      <ion-row>
        <ion-col size="12" size-xl="1">
        </ion-col>
        <ion-col>
          <ion-card mode="ios" class="uniform-card-height" *ngIf="plan">
            <ion-item lines="none" color="transparent">
              <h1>
                  <ion-text>{{ plan?.planName }}</ion-text>
              </h1>
              <ion-text slot="end">$ {{plan?.price * (plan?.allowedLicense ?  plan.allowedLicense : 1) | number:'1.2-2'}} / mo</ion-text>
            </ion-item>
            <ion-progress-bar [color]="plan?.color" value="1"></ion-progress-bar>
            <ion-card-content>
              <ion-item no-lines>
                <ion-label class="ion-text-center">
                  <h1>
                    <ion-text class="large-title">$ {{ plan?.price | number:'1.2-2'}}</ion-text> / mo <br/> <small>per user</small>
                  </h1>
                </ion-label>
              </ion-item>
              <ion-item lines="none" class="" *ngFor="let tag of plan.tags;">
                <p class="ion-text-start">{{tag}}</p>
                <ion-icon slot="start" color="green" name="checkmark-circle-outline"></ion-icon>
              </ion-item>
            </ion-card-content>
          </ion-card>
        </ion-col>
        <ion-col>
          <ion-card mode="ios" class="uniform-card-height">
            <ion-item lines="" color="transparent">
              <h1>
                  <ion-text color="">Review and pay</ion-text>
              </h1>
              <ion-icon color="medium" slot="end" name="card"></ion-icon>
            </ion-item>
            <ion-card-content>
              <ion-item>
                <ion-icon name="apps" color="medium"></ion-icon>
                <ion-label class="ion-text-end">{{ orgProfile?.companyName }}</ion-label>
              </ion-item>
              <ion-item *ngIf="plan?.coupon">
                <ion-icon  name="paper-plane" color="medium"></ion-icon>
                <ion-label class="ion-text-end">{{ plan?.coupon?.couponCode }}</ion-label>
              </ion-item>
              <ion-item>
                <ion-label><ion-icon  name="people" color="medium"></ion-icon></ion-label>
                <ion-input class="ion-text-end hide-number-arrow"
                inputmode="numeric"
                type="number"
                required
                [(ngModel)]="plan.allowedLicense"
                color="primary"
                (ionChange)="checkSubscriptionValidity()"
                ></ion-input>
              </ion-item>
              <ion-item>
                <ion-icon name="mail" color="medium"></ion-icon>
                <ion-label class="ion-text-end">{{ orgProfile?.email }}</ion-label>
              </ion-item>
              <ion-item id="paypal" #paypal [class]="'ion-margin-top ' + (validSubscription ? '' : 'ion-hide')" lines="none"></ion-item>
              <ion-item *ngIf="!validSubscription" lines="none">
                <ion-label class="ion-text-wrap ion-text-center">
                  <ion-text color="danger">
                    <p>
                      Please note that the subscription can not be processed at this stage due to the following reasons:
                    </p>
                    <p *ngFor="let msg of subscripTionAlertMsg">
                      {{msg}}
                    </p>
                    <!-- <p *ngIf="!plan.allowedLicense || orgProfile.noOfUserAllowed - orgProfile.noOfFreeLicense > plan.allowedLicense">
                      Please note that there are {{orgProfile.noOfUserAllowed - orgProfile.noOfFreeLicense}} active users. The no of users selected now is {{plan.allowedLicense}}. Please select at least {{orgProfile.noOfUserAllowed - orgProfile.noOfFreeLicense}} users.
                    </p>
                    <p>
                      Total credit for the selected paln and no of users is less than the current usage.
                    </p> -->
                  </ion-text>
                </ion-label>
              </ion-item>
            </ion-card-content>
          </ion-card>
        </ion-col>
        <ion-col size="12" size-xl="1">
        </ion-col>
      </ion-row>
    </ion-col>
  </ion-row>
</ion-content>
