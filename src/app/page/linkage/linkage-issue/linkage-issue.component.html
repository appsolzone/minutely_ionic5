<ion-item lines="none" *ngIf="viewMode=='edit'">
  <ion-label class="ion-text-end">
    <p><ion-text color="medium">Seach and link issues</ion-text></p>
  </ion-label>
  <ion-buttons slot="end" *ngIf="linkedIssues">
    <ion-button slot="end" (click)="showSearchList=!showSearchList">
      <ion-icon slot="icon-only" [name]="showSearchList ? 'close' : 'search'"></ion-icon>
    </ion-button>
  </ion-buttons>
</ion-item>
<ion-card *ngIf="!showSearchList && linkedIssues?.length==0" class="ion-no-padding">
  <ion-item lines="none">
    <ion-icon name="information-circle-outline"  slot="start" color="medium"></ion-icon>
    <ion-label class="ion-text-wrap" color="medium">
      <p>
        No linked issue found. If you have edit permission, you may wish to
        link other issues through edit option,
        else ask the owner to link the related issues.
      </p>
    </ion-label>
  </ion-item>
</ion-card>
<app-issue-list *ngIf="showSearchList"
  viewMode="linkage"
  [excludeList]="linkedIssues"
  (onSelectIssue)="linkSelectedIssue($event)"
  ></app-issue-list>
<ion-item *ngIf="showSearchList && linkedIssues?.length>0" color="light">
  <ion-icon slot="start" name="attach"></ion-icon>
  <ion-label>
    <h2>Selected linked issues</h2>
  </ion-label>
</ion-item>
<ion-card class="ion-no-padding" *ngFor="let t of linkedIssues ? linkedIssues : [null,null];let i=index;"
  [button]="viewMode=='edit' ? false : true" (click)="viewMode=='edit' ? null : openIssueDetails(t)">
  <ion-item lines="none" color="transparent">
    <!-- <ion-buttons slot="start"> -->
      <ion-button slot="start" fill="solid" color="warning" class="ion-no-margin margin-end-5px">
        <ion-icon slot="start" name="locate"></ion-icon>
        {{t?.data.targetCompletionDate| date : 'mediumDate'}}
        <ion-skeleton-text *ngIf="!t" animated style="width: 30%"></ion-skeleton-text>
      </ion-button>
      <ion-button slot="start"  fill="solid" color="light" class="ion-no-margin">
        <ion-icon slot="start" name="pencil"></ion-icon>
        {{t?.data.issueInitiationDate| date : 'mediumDate'}}
        <ion-skeleton-text *ngIf="!t" animated style="width: 30%"></ion-skeleton-text>
      </ion-button>
    <!-- </ion-buttons> -->
    <ion-buttons *ngIf="viewMode=='edit'" slot="end">
      <ion-button *ngIf="t?.state!='delete'" slot="end" (click)="delinkSelectedIssue(t,i)">
        <ion-icon slot="icon-only" name="trash-bin" color="danger"></ion-icon>
      </ion-button>
      <ion-button *ngIf="t?.state=='delete'" slot="end" (click)="undoDelinkIssue(t,i)">
        <ion-icon slot="icon-only" name="arrow-undo" color="success"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-item>
  <ion-card-content class="ion-no-padding ion-padding-start ion-padding-end">
    <ion-item lines="none" class="ion-no-padding"  color="transparent">
      <ion-label class="ion-no-padding ion-no-margin ion-text-wrap">
        <h1 *ngIf="t"><small>{{t.data.issueTitle}}</small></h1>
        <ion-skeleton-text *ngIf="!t" animated style="width: 80%"></ion-skeleton-text>
      </ion-label>
    </ion-item>
    <ion-item class="ion-no-padding" lines="none"  color="transparent">
      <img src="{{(t?.data.issueOwner.picUrl) ? t?.data.issueOwner?.picUrl : 'assets/shapes.svg'}}"
      (error)="profileImgErrorHandler(t.data.issueOwner)"
        style="height:30px; width:30px;border-radius:50%;object-fit: cover; overflow: hidden;"
        />
      <ion-label class="ion-padding-start">
        <h2  *ngIf="t">Owner</h2>
        <p *ngIf="t"><ion-text color="medium">{{t.data.issueOwner.name}}</ion-text></p>
        <ion-skeleton-text *ngIf="!t" animated style="width: 40%"></ion-skeleton-text>
        <ion-skeleton-text *ngIf="!t" animated style="width: 60%"></ion-skeleton-text>
      </ion-label>
    </ion-item>
    <ion-item class="ion-no-padding" lines="none"  color="transparent">
      <img src="{{(t?.data.issueInitiator.picUrl) ? t?.data.issueInitiator?.picUrl : 'assets/shapes.svg'}}"
      (error)="profileImgErrorHandler(t.data.issueInitiator)"
        style="height:30px; width:30px;border-radius:50%;object-fit: cover; overflow: hidden;"
        />
      <ion-label class="ion-padding-start">
        <h2  *ngIf="t">Initiator</h2>
        <p *ngIf="t"><ion-text color="medium">{{t.data.issueInitiator.name}}</ion-text></p>
        <ion-skeleton-text *ngIf="!t" animated style="width: 40%"></ion-skeleton-text>
        <ion-skeleton-text *ngIf="!t" animated style="width: 60%"></ion-skeleton-text>
      </ion-label>
    </ion-item>
  </ion-card-content>
</ion-card>
