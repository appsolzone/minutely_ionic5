<ion-row>
  <ion-searchbar
    [(ngModel)]="searchText"
    (ionClear)="onClear($event)"
    (ionChange)="ionChange($event)"
  >
  </ion-searchbar>
</ion-row>
<ion-toolbar mode="ios">
  <ion-item *ngIf="!searchText?.trim()" lines="none">
    <ion-label>
      <p class="ion-text-wrap">Search projects by name, status and keywords. Use <b>match any</b> option to widen the search results.</p>
    </ion-label>
  </ion-item>
  <ion-segment *ngIf="searchText?.trim()" [value]="searchMode" (ionChange)="SearchOptionsChanged($event)" color="primary">
    <ion-segment-button value="all">
      <ion-label>Match all keywords</ion-label>
    </ion-segment-button>
    <ion-segment-button value="any">
      <ion-label>Match any keyword</ion-label>
    </ion-segment-button>
  </ion-segment>
  <ion-button fill="clear" slot="end" (click)="gotoAddProject()" class="ion-hide-md-up">
    <ion-icon name="add-circle-outline" slot="start" color="primary"></ion-icon>
    Add
  </ion-button>
  <ion-button *ngIf="!addProject" fill="clear" slot="end" (click)="openAddProject()"  class="ion-hide-md-down">
    <ion-icon name="add-circle-outline" slot="start" color="primary"></ion-icon>
    Add
  </ion-button>
</ion-toolbar>

<ion-list>
  <ion-item *ngIf="allProjects.length==0 && searchText?.trim()" lines="none">
    <ion-label>
      <p class="ion-text-wrap">Search projects by name, status and keywords. Use <b>match any</b> option to widen the search results.</p>
    </ion-label>
  </ion-item>
  <ion-card *ngFor="let project of allProjects; let i=index;">
    <ion-header mode="ios">
      <ion-toolbar color="light">
        <!-- <ion-item color="transparent" lines="none" button="true" (click)="showProjectDetails(project)">
          <ion-icon name="bookmark-outline" slot="start" size="small"></ion-icon>
          <ion-label>{{project.data.title}}</ion-label>
        </ion-item> -->
        <ion-item color="transparent" lines="none" button="true" (click)="gotoProjectDetails(project)">
          <ion-icon name="bookmark-outline" slot="start" size="small"></ion-icon>
          <ion-label>{{project.data.title}}</ion-label>
        </ion-item>
      </ion-toolbar>
    </ion-header>
    <ion-item lines="none">
      <ion-label>
        <ion-chip>
          <ion-icon name="calendar"></ion-icon>
          <ion-label>{{project.data.inceptionDate | date : 'mediumDate'}}</ion-label>
        </ion-chip>
        <ion-chip color="primary">
          <ion-icon name="calendar"></ion-icon>
          <ion-label>{{project.data.closureDate ? (project.data.closureDate | date : 'mediumDate') : 'Ongoing'}}</ion-label>
        </ion-chip>
        <ion-row>
          <ion-col class="ion-no-padding ion-no-margin">
            <ion-label class="ion-text-center">
              <h2>{{project.data.activityCount}}</h2>
              <p>activities</p>
            </ion-label>
          </ion-col>
          <ion-col class="ion-no-padding ion-no-margin">
            <ion-chip color="transparent">
              <ion-icon name="body" color="medium"></ion-icon>
              <ion-label>{{project.data.estimatedEffort!=null ? project.data.estimatedEffort.toFixed(0)+' hr ' : 'Not available'}}</ion-label>
            </ion-chip>
          </ion-col>
          <ion-col class="ion-no-padding ion-no-margin">
            <ion-chip color="transparent">
              <ion-icon name="body" color="primary"></ion-icon>
              <ion-label>{{project.data.totalEffort!=null ? project.data.totalEffort.toFixed(0)+' hr' : 'Not available'}}</ion-label>
            </ion-chip>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col class="ion-no-padding ion-no-margin">
            <ion-label class="ion-text-center">
              <h2>$</h2>
              <p>cost</p>
            </ion-label>
          </ion-col>
          <ion-col class="ion-no-padding ion-no-margin">
            <ion-chip color="transparent">
              <ion-icon name="cash" color="medium"></ion-icon>
              <ion-label>{{project.data.estimatedCost!=null ? '$ ' + project.data.estimatedCost.toFixed(0) : 'Not available'}}</ion-label>
            </ion-chip>
          </ion-col>
          <ion-col class="ion-no-padding ion-no-margin">
            <ion-chip color="transparent">
              <ion-icon name="cash" color="primary"></ion-icon>
              <ion-label>{{project.data.totalBillableAmount!=null ? '$ ' + project.data.totalBillableAmount.toFixed(0) : 'Not available'}}</ion-label>
            </ion-chip>
          </ion-col>
        </ion-row>
      </ion-label>
    </ion-item>
  </ion-card>
</ion-list>
