<ion-row>
  <ion-col size="12" class="ion-hide-lg-up">
    <ion-item *ngIf="showSearchModesforUpcomming" lines="none">
      <ion-label class="ion-text-wrap">
        <h1>Search Meetings</h1>
      </ion-label>
      <ion-buttons slot="end">
        <ion-button (click)="showHideSearch()">
          <ion-icon name="contract" slot="icon-only"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ion-item>
  </ion-col>
  <ion-toolbar *ngIf="viewMode!='upcoming' || showSearchModesforUpcomming">
    <ion-searchbar
      [(ngModel)]="searchText"
      (ionClear)="onClear($event)"
      (ionChange)="ionChange($event)"
    >
    </ion-searchbar>
  </ion-toolbar>
  <ion-toolbar mode="ios" *ngIf="viewMode!='upcoming' || showSearchModesforUpcomming">
    <ion-row>
      <ion-col>
        <ion-segment *ngIf="!searchText?.trim()" [value]="options.calendarOptions.pickMode" (ionChange)="calendarOptionsChanged($event)">
          <ion-segment-button value="single">
            <ion-label>Single Date</ion-label>
          </ion-segment-button>
          <ion-segment-button value="range">
            <ion-label>Date Range</ion-label>
          </ion-segment-button>
        </ion-segment>
        <ion-segment *ngIf="searchText?.trim()" [value]="searchMode" (ionChange)="SearchOptionsChanged($event)" color="primary">
          <ion-segment-button value="all">
            <ion-label>Match all keywords</ion-label>
          </ion-segment-button>
          <ion-segment-button value="any">
            <ion-label>Match any keyword</ion-label>
          </ion-segment-button>
        </ion-segment>
      </ion-col>
      <ion-col>
        <ion-segment [value]="searchModeUser" (ionChange)="SearchUserOptionsChanged($event)">
          <ion-segment-button value="user">
            <ion-label>My meetings</ion-label>
          </ion-segment-button>
          <ion-segment-button value="all">
            <ion-label>All meetings</ion-label>
          </ion-segment-button>
        </ion-segment>
      </ion-col>
    </ion-row>
  </ion-toolbar>
  <ion-calendar
    *ngIf="!searchText?.trim() && (viewMode!='upcoming' || showSearchModesforUpcomming)"
    class="app-calendar"
    [options]="options.calendarOptions"
    (select)="onSelect($event)"
    (selectStart)="onSelectStart($event)"
    (selectEnd)="onSelectEnd($event)"
    (monthChange)="monthChanges($event)"
    >
  </ion-calendar>
  <ion-col>
    <ion-toolbar *ngIf="viewMeetingResult?.length==0 && (viewMode!='upcoming' || showSearchModesforUpcomming)">
      <ion-item>
        <ion-label>
          <h1>Search meetings</h1>
        </ion-label>
      </ion-item>
      <ion-item lines="none">
        <ion-label class="ion-text-wrap">
          <p *ngIf="dateRange.startDate || (searchText && searchText.trim().length>=2)">Sorry, we could not find any meeting for the {{dateRange.startDate? 'date' : 'search keywords'}}.</p>
          <p>If you wish to create a new meeting, click on the <b>add</b> meetings button at the <b>bottom</b> of the screen.</p>
          <p>To search meetings by date, select <b>a date</b> or <b>a date range</b>.</p>
          <p>To search meetings by <b>keywords</b>, enter one or more keywords.</p>
          <p class="ion-text-center"><ion-text color="medium"><small>Here are few tips to help you with searching ... <br/>
            Try searching words appear in meeting title, name or tags<br/>
            Try searching status e.g. <b>open</b>, <b>cancel</b> or <b>completed</b><br/>
            Try seraching one or two words<br/>
            Try <b>match any keyword</b> option for wider search result <br/></small></ion-text>
          </p>

        </ion-label>
      </ion-item>
    </ion-toolbar>
    <ion-toolbar *ngIf="viewMeetingResult?.length==0 && viewMode=='upcoming' && !showSearchModesforUpcomming">
      <ion-item>
        <ion-label class="ion-text-wrap">
          <h1>No upcoming meetings found</h1>
        </ion-label>
        <ion-buttons slot="end" class="ion-hide-lg-up">
          <ion-button (click)="showHideSearch()">
            <ion-icon name="search" slot="icon-only"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-item>
      <ion-item lines="none">
        <ion-label class="ion-text-wrap">
          <p>No meetings found for today. Let's create a meeting.</p>
          <p class="ion-hide-lg-up">To search meetings click on the serach button.
          </p>
        </ion-label>
      </ion-item>
      <ion-item lines="none">
        <ion-button class="ion-hide-md-down" slot="end" size="default"
        (featureClick)="gotoAddMeeting()"
        appFeatureCheck
        [featureIdList]="['create-meeting']"
        >
          Create meeting
        </ion-button>
        <ion-button class="ion-hide-md-up" slot="start" size="default"
        (featureClick)="gotoAddMeeting()"
        appFeatureCheck
        [featureIdList]="['create-meeting']"
        >
          Create meeting
        </ion-button>
      </ion-item>
    </ion-toolbar>
    <ion-toolbar *ngIf="viewMeetingResult?.length>0 && viewMode=='upcoming' &&  !showSearchModesforUpcomming">
      <ion-item>
        <ion-label>
          <h1>Your upcoming meetings</h1>
        </ion-label>
        <ion-buttons slot="end" class="ion-hide-lg-up">
          <ion-button (click)="showHideSearch()">
            <ion-icon name="search" slot="icon-only"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-item>
    </ion-toolbar>
    <ion-card class="ion-no-padding" *ngFor="let m of viewMeetingResult ? viewMeetingResult : [null,null,null];"  [button]="viewMode!='linkage'" (click)="openMeetingDetails(m)">
      <ion-item lines="none" color="transparent">
        <ion-chip *ngIf="m" size="small"  slot="start" color="{{m.data.status=='OPEN' ? 'primary' : m.data.status=='CANCEL' ? 'danger' : 'green'}}">{{m.data.meetingStart| date : 'shortTime'}} - {{m.data.meetingEnd| date : 'shortTime'}}</ion-chip>
        <ion-label class="ion-no-padding ion-no-margin">
          <h3 *ngIf="m">{{m.data.meetingStart| date : 'mediumDate'}}</h3>
          <ion-skeleton-text *ngIf="!m" animated style="width: 70%"></ion-skeleton-text>
        </ion-label>
        <ion-icon slot="end" name="bookmark" size="small" color="{{m?.data.status=='OPEN' ? 'warning' : 'success'}}"></ion-icon>
      </ion-item>
      <ion-card-content class="ion-no-padding ion-padding-start ion-padding-end">
        <ion-item lines="none" class="ion-no-padding"  color="transparent">
          <ion-label class="ion-no-padding ion-no-margin ion-text-wrap">
            <h1 *ngIf="m"><small>{{m.data.meetingTitle}}</small></h1>
            <ion-skeleton-text *ngIf="!m" animated style="width: 80%"></ion-skeleton-text>
            <p class="app-therelines ion-text-justify">
              <ion-text  *ngIf="m" color="medium">{{m.data.agendas}}</ion-text>
              <ion-skeleton-text *ngIf="!m" animated style="width: 100%"></ion-skeleton-text>
              <ion-skeleton-text *ngIf="!m" animated style="width: 100%"></ion-skeleton-text>
            </p>
          </ion-label>
        </ion-item>
        <ion-item class="ion-no-padding" lines="none"  color="transparent">
          <ion-icon *ngIf="!m?.data.ownerId?.picUrl" color="green" name="person-circle" slot="start" size="large"></ion-icon>
          <img *ngIf="m?.data.ownerId?.picUrl" slot="start"
            src="{{(m?.data.ownerId?.picUrl) ? m?.data.ownerId?.picUrl : ''}}"
            (error)="profileImgErrorHandler(m?.data.ownerId)"
            style="height:30px; width:30px;border-radius:50%;"
            />
          <ion-label>
            <h2  *ngIf="m">Organiser</h2>
            <p *ngIf="m"><ion-text color="medium">{{m.data.ownerId.name}}</ion-text></p>
            <ion-skeleton-text *ngIf="!m" animated style="width: 40%"></ion-skeleton-text>
            <ion-skeleton-text *ngIf="!m" animated style="width: 60%"></ion-skeleton-text>
          </ion-label>
        </ion-item>
        <ion-item *ngIf="m" class="ion-no-padding" lines="none" color="transparent">
            <img *ngFor="let imgs of m.data.attendeeList | slice:0:3"
              src="{{(imgs.picUrl) ? imgs.picUrl : ''}}"
              (error)="profileImgErrorHandler(imgs)"
              style="height:20px; width:20px;border-radius:50%;"
            />
          <span  class="ion-padding-start" *ngIf="m.data.attendeeList.length > 3"><small>+{{m.data.attendeeList.length - 3}} more</small></span>
          <ion-buttons *ngIf="viewMode=='linkage'" slot="end">
            <ion-button slot="end"
            (featureClick)="onLinkMeeting(m)"
            appFeatureCheck
            [featureIdList]="['link-project-item']"
            >
              <ion-icon name="attach" slot="icon-only"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-item>
        <ion-item *ngIf="!m" class="ion-no-padding" lines="none" color="transparent">
            <ion-icon class="ion-no-padding ion-no-margin" *ngFor="let imgs of [null,null,null]"
              name="person-circle" color="medium"
              slot="start"
            ></ion-icon>
        </ion-item>
      </ion-card-content>
    </ion-card>
    <ion-toolbar *ngIf="viewMeetingResult?.length>=15 && (viewMode!='upcoming' || showSearchModesforUpcomming)">
      <ion-item>
        <ion-label>
          <h1>Refine your search</h1>
        </ion-label>
      </ion-item>
      <ion-item lines="none">
        <ion-label class="ion-text-wrap">
          <p *ngIf="dateRange.startDate || (searchText && searchText.trim().length>=2)">
            Have you found the meeting you are looking for? <br/>
            It seems that the serach is matching too many rows.
          </p>
          <p>Try refining the serach conditions.</p>
          <p>To search meetings by date, select <b>a date</b> or <b>a shorter date range</b>.</p>
          <p>To search meetings by <b>keywords</b>, enter <b>two or more</b> keywords.</p>
          <p>
            Avoid searching only by status e.g. <b>open</b>, <b>cancel</b> or <b>completed</b> as these will lead to wider match<br/>
            Try <b>match all keyword</b> option to limit search result <br/>
          </p>

        </ion-label>
      </ion-item>
    </ion-toolbar>
  </ion-col>
</ion-row>
